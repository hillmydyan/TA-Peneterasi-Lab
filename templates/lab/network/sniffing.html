{% extends "layout/base.html" %}

{% block title %}Network Sniffing Simulation - Virtual Pen Test Lab{% endblock %}

{% block content %}
<div class="p-4">
    <div class="flex flex-col md:flex-row justify-between items-center mb-6">
        <div>
            <h1 class="text-3xl font-bold">Network Sniffing Simulation</h1>
            <p class="text-base-content/70">Simulasi serangan Network Sniffing untuk memonitor traffic jaringan.</p>
        </div>
    </div>

    <div class="flex flex-col lg:flex-row gap-6">
        <!-- LEFT COLUMN: STEPS -->
        <aside class="w-full lg:w-1/3">
            <div class="card bg-base-100 shadow-xl">
                <div class="card-body p-4">
                    <h3 class="card-title text-lg mb-4">Guide Instructions</h3>

                    <div class="space-y-4">
                        <div class="collapse collapse-arrow border border-base-300 bg-base-100 rounded-box">
                            <input type="checkbox" checked="checked" />
                            <div class="collapse-title text-xl font-medium">
                                1. Start Virtual Machines
                            </div>
                            <div class="collapse-content">
                                <p>Nyalakan VM Attacker dan Victim. Pastikan keduanya berjalan lancar.</p>
                            </div>
                        </div>

                        <div class="collapse collapse-arrow border border-base-300 bg-base-100 rounded-box">
                            <input type="checkbox" />
                            <div class="collapse-title text-xl font-medium">
                                2. Config Network Mode
                            </div>
                            <div class="collapse-content">
                                <p>Pastikan kedua VM terhubung dalam satu jaringan internal (Host-Only / Internal
                                    Network) agar dapat saling berkomunikasi.</p>
                            </div>
                        </div>

                        <div class="collapse collapse-arrow border border-base-300 bg-base-100 rounded-box">
                            <input type="checkbox" />
                            <div class="collapse-title text-xl font-medium">
                                3. Identify Interface
                            </div>
                            <div class="collapse-content">
                                <p>Cek interface jaringan yang aktif pada Attacker VM:</p>
                                <div class="mockup-code bg-base-300 text-base-content mt-2">
                                    <pre data-prefix="$" class="whitespace-pre-wrap break-all"><code>ip a</code></pre>
                                </div>
                            </div>
                        </div>

                        <div class="collapse collapse-arrow border border-base-300 bg-base-100 rounded-box">
                            <input type="checkbox" />
                            <div class="collapse-title text-xl font-medium">
                                4. Start Sniffing
                            </div>
                            <div class="collapse-content">
                                <p>Jalankan <strong>tcpdump</strong> atau buka <strong>Wireshark</strong> untuk mulai
                                    menangkap paket pada interface <code>eth0</code>.</p>
                                <div class="mockup-code bg-base-300 text-base-content mt-2">
                                    <pre data-prefix="$"
                                        class="whitespace-pre-wrap break-all"><code>tcpdump -i eth0</code></pre>
                                </div>
                            </div>
                        </div>

                        <div class="collapse collapse-arrow border border-base-300 bg-base-100 rounded-box">
                            <input type="checkbox" />
                            <div class="collapse-title text-xl font-medium">
                                5. Generate Traffic
                            </div>
                            <div class="collapse-content">
                                <p>Di Victim VM, lakukan aktivitas jaringan seperti <code>ping</code> atau akses web
                                    HTTP (non-HTTPS).</p>
                                <div class="mockup-code bg-base-300 text-base-content mt-2">
                                    <pre data-prefix="$"
                                        class="whitespace-pre-wrap break-all"><code>ping 192.168.1.10</code></pre>
                                </div>
                            </div>
                        </div>

                        <div class="collapse collapse-arrow border border-base-300 bg-base-100 rounded-box">
                            <input type="checkbox" />
                            <div class="collapse-title text-xl font-medium">
                                6. Analyze Packet
                            </div>
                            <div class="collapse-content">
                                <p>Analisis paket yang tertangkap. Perhatikan Source IP, Destination IP, Protocol, dan
                                    data payload jika tidak terenkripsi.</p>
                            </div>
                        </div>

                        <div class="collapse collapse-arrow border border-base-300 bg-base-100 rounded-box">
                            <input type="checkbox" />
                            <div class="collapse-title text-xl font-medium">
                                7. Conclusion
                            </div>
                            <div class="collapse-content">
                                <p>Simpulkan informasi apa saja yang bisa didapatkan dari sniffing traffic yang tidak
                                    terenkripsi.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- RIGHT COLUMN: VM PREVIEW -->
        <main class="w-full lg:w-2/3">
            <div class="grid grid-cols-1 gap-6">
                <!-- Sniffer VM -->
                <div class="card bg-base-100 shadow-xl">
                    <div class="card-body p-4">
                        <h3 class="card-title text-sm mb-2">Attacker VM (Sniffer)</h3>
                        <div id="attacker-vm-container"
                            class="bg-base-300 h-96 rounded-box flex items-center justify-center relative overflow-hidden">
                            <div class="text-center text-base-content/50">
                                <p>VM is ready</p>
                            </div>
                        </div>
                        <div class="card-actions justify-center mt-4">
                            <button class="btn btn-primary btn-sm"
                                onclick="startVM('attacker-vm-container', '{{ attacker_url }}', 'sniffing', 'attacker')">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <polygon points="5 3 19 12 5 21 5 3"></polygon>
                                </svg>
                                Start VM
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Victim VM -->
                <div class="card bg-base-100 shadow-xl">
                    <div class="card-body p-4">
                        <h3 class="card-title text-sm mb-2">Victim VM (Target)</h3>
                        <div id="target-vm-container"
                            class="bg-base-300 h-96 rounded-box flex items-center justify-center relative overflow-hidden">
                            <div class="text-center text-base-content/50">
                                <p>VM is ready</p>
                            </div>
                        </div>
                        <div class="card-actions justify-center mt-4 gap-2">
                            <button class="btn btn-primary btn-sm"
                                onclick="startVM('target-vm-container', '{{ target_url }}', 'sniffing')">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <polygon points="5 3 19 12 5 21 5 3"></polygon>
                                </svg>
                                Start VM
                            </button>
                            <button class="btn btn-warning btn-sm" onclick="resetVM('sniffing')">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path>
                                    <path d="M3 3v5h5"></path>
                                </svg>
                                Reset VM
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>
{% endblock %}